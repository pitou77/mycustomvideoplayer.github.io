
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>doodstreams</title>
</head>
<style>
body {
	margin:0px;
}
img {
	width: 100%; max-width:480px; 
	height: 250px; 
	object-fit: cover;
	object-position: 25% 25%; 
} 
#videoFrame {
    position: sticky;
    top: 0px;
}	
</style>	
<body>
<iframe id="videoFrame" width="100%" src="" height="0" frameborder="0" allowfullscreen></iframe>	
    <div id="result-container"></div>

    <script>
if (window.location.href.includes("?data=")==true) {
	console.log("data rendered");
	var jsonData = window.location.href.replace("?data=","@").replace(/.+@/,"");
	var parsedData = JSON.parse(jsonData);
	console.log(parsedData.result.files[0].file_code); 

}else{
	
const apiUrl = "https://pitou77.github.io/doodstream/data.json",
    resultContainer = document.getElementById("result-container");
fetch(apiUrl).then((t => {
    if (!t.ok) throw new Error(`HTTP error! Status: ${t.status}`);
    return t.json()
})).then((t => {
	var isi = t.result.files;
		for (var i = 0; i < isi.length; i++) {
	
	const videoId = isi[i].file_code;		
        const videoLink = document.createElement("a");
        videoLink.href = 'https://doods.pro/e/'+isi[i].file_code;
        videoLink.textContent = isi[i].title;		
	const thumbnailImg = document.createElement("img");
        thumbnailImg.src = isi[i].single_img;
        thumbnailImg.alt = isi[i].title;
        videoLink.addEventListener("click", () => {
            loadVideo(videoId);
        });
        thumbnailImg.addEventListener("click", () => {
            loadVideo(videoId);
        });		
	resultContainer.appendChild(thumbnailImg);
	resultContainer.appendChild(document.createElement("br"));
	resultContainer.appendChild(videoLink);			
	resultContainer.appendChild(document.createElement("br"));
	resultContainer.appendChild(document.createElement("br"));
			
function loadVideo(videoId) {
    const videoFrame = document.getElementById("videoFrame");
    videoFrame.src = `https://doods.pro/e/${videoId}`;
    videoFrame.height = `360`;
}
			
		}

    
})).catch((t => {
    console.error("Fetch error:", t)
}));

	
}    </script>
</body>
</html>
